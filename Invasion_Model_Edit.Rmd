---
title: "M. Calvescens Invasion Model"
author: "David Lewis"
date: "Jan 25, 2021"
output: 
  html_document: 
    theme: cerulean
    toc: true
    smooth_scroll: false
    toc_depth: 2
    toc_float: true
    number_sections: false
    df_print: paged
    code_folding: hide
    fig_caption: true
---

<style type="text/css">
h1.title{font-size:22px; text-align:center;}
h4.author{font-size:16px; text-align:center;}
h4.date{font-size:16px; text-align:center;}
body{ /* Normal  */ font-size: 14px}
td {  /* Table   */ font-size: 12px}
h1 { /* Header 1 */ font-size: 18px}
h2 { /* Header 2 */ font-size: 16px}
h3 { /* Header 3 */ font-size: 14px}
code.r{ /* Code block */ font-size: 12px}
pre { /* Code block */ font-size: 12px}
p.caption {font-size: 0.9em} 
</style>

```{r setup, echo=FALSE}
# Use Session menu to setwd() to source file location.
rm(list=ls()) # clean up
library(knitr)
library(readxl)
library(kdensity)
library(popbio)
library(openxlsx)
library(tidyverse)
library(ggplot2)

gr <- (1+sqrt(5))/2 # golden ratio for figures
# Default chunk options

opts_chunk$set(comment="  >", 
               collapse=TRUE, 
               echo=TRUE,
               fig.width=6,
               fig.asp=1/gr,
               dev=c("png")   # "jpeg" best for docx
)              # "svg" also good for html.

reldif <- function(a,b) # robust comparison of numbers
  max(2*abs(a-b))/(abs(a)+abs(b)+1.0E-40)

options(digits = 4)
options(warn = -1)

```

#Dataset Import

```{r dataset}
library(readr)
Miconia_distance_data <- read_csv("Lewis_R0_data.csv")
```


##Dispersal Kernel {.tabset}

Dispersal distance, the Euclidian distance between ‘start’ and ‘end’ points of a dispersal event, is recognized as a fundamental characteristic of the dispersal process, defined here as the movement of seeds from their natal site (adult tree) to a new place of potential establishment (Natan et al. 2015). The statistical distribution of dispersal distances in a population is termed the ‘dispersal kernel’. It is a probability density function (pdf) describing the distribution of the post-dispersal locations relatively to the source point (Natan et al. 2015, Mollison 1977). 

###PDF

The probability density function for this model is based on the data collected from miconia management actions between 1991 and 2016 by the National Park Service and Maui Invasive Species Council. The distances in the dataset range from 0 meters to 1608 meters.
```{r Kernel Density Estimates, fig.cap = 'Figure 1. The probabikity density function that shows the likilhood of how far a seed with disperse (in meters) from its origin. Ranges from 0 to 1608 meters', echo=FALSE}
library(readr)
qryNT_days_dist_dem_p365_nc <- read_csv("Lewis_R0_data.csv")
Distance <- qryNT_days_dist_dem_p365_nc$Dist
KDE <- density(Distance)
plot(KDE, 
     main = "Dispersal Kernel - PDF",
     xlab = "Distance (meters)",
     ylab = "Density")
```


###Histogram

```{r Dispersal Histogram, echo=FALSE, fig.cap= 'Figure 2. Histogram showing frequency at which distances seeds may disperse to between 0 and 1608 meters.'}
h <- hist(Distance, 
          xaxp = c(0, 1650, 33),
          col = "red", 
          breaks = 33,
          xlab = "Binned Distance (meters)"
          )
```

#Models      

#Population Model

I built out a simplified stage matrix model to project population dynamics of miconia over a 20 year period in 1 year intervals in an illustrative uninvaded environment. The purpose of this model is generate a population of adult trees that occur over the 20 year period from one initial adult tree. The 3 by 3 matrix consists of only 5 basic life history traits as parameters:

1. Germination rate and seedling survival
2. Adult fecundity 
3. Juvenile survivorship
4. Juveniles that progress to adulthood
5. Adult surivorship

It is important to note that this simplified model assumes that density dependency, carrying capacity, and by extension Allee effects have little siginificance in simplified individual population models with short time periods. Therefore they have been omitted from the current model. However, this model is simple enough to be adapted to include these factors.

###Model Parameters

```{r Model Parameters}
# Establish model parameters

G <- 0.000055               # Germination rate and seedling survival
Fa <- 36855                 # Fecundity of adults
Pj1 <- 0.85                 # Juvenile survivorship 
Pj2 <- 0.15                 # Juvenile survivorship to adults
Ma <- 0.90                 # Adult survivorship
```

###Life Stage Matrix Model

```{r Projection Matrix}
# Built simple 3 x 3 life stage matrix

projection_matrix <- matrix(
  c(0,     0,          Fa,
    G,     Pj1,        0,
    0,     Pj2,        Ma )
  , nrow=3, byrow=TRUE
)

projection_matrix

```
The package 'popbio' was used to compute the population growth rate. Miconia has  a growth rate of 1.3 ~ 1.45 in tropical climates (Hester, Leary).

###Growth Rate

The package 'popbio' was used to compute the population growth rate. Miconia has  a growth rate of 1.3 ~ 1.45 in tropical climates (Hester, Leary).

```{r Compute lambda}
# 'popbio' package to compute lambda (population growth rate). 
# lambda < 1, population decreasing
# lambda = 1, population stable
# lamdba > 1, population increasing

lambda(projection_matrix)
```

###Set Initial Abundance

Initial abundance is set at 1 adult tree.
```{r Abundance}
# Initial abundance for each life stage (Seeds, juveniles, adults).

Abundance_year0 <- (matrix(c(0, 0, 1), ncol=1))
Abundance_year0
```

```{r Year 1, echo=FALSE}
# Initial run to test the code through the first time step.

Year1 <- projection_matrix %*% Abundance_year0   # matrix multiplication
```

```{r Year 2, echo=FALSE}
# Project time step to verify matrices are compatible.

Year2 <- projection_matrix %*% Year1  # matrix multiplication
```

##Individual Population Demographics Projected Over 20 Year Period

```{r Population Model}
# Built loop to project out to 20 year time horizon

nYears <- 20                                            # set the number of years to project
TimeMat <- projection_matrix                            # define the proj matrix as time matrix
InitAbund <- Abundance_year0                            # define the initial abundance ay yr 0

allYears <- matrix(0,nrow=nrow(TimeMat),ncol=nYears+1)  # build a storage array for all abundances
rownames(allYears) <- c("Seeds", "Juveniles", "Adults") # establish row names
colnames(allYears) <- paste("Year", 0:20)              # establish column names
allYears[,1] <- InitAbund                               # set the year 0 abundance
for(t in 2:(nYears+1)){                                 # loop through all years
  allYears[,t] <-  TimeMat %*% allYears[,t-1]
}

library(kableExtra)
kable(allYears, digits = 0,  caption = "Table 1. The population of each life stage by year.") %>%
  kable_styling("striped", full_width = F) %>%
  row_spec(0, angle = -90) %>%
  scroll_box(width = "750px", height = "225px")
```



#Spread & Management by Generation {.tabset}

The second piece of the puzzle is the spatial component. Now that we know what the population demographics of an individual adult tree look like over a 20 year period, we can find out where the population occurs relative to the maternal source. Below is a model that functions in four steps at each time step:

1. Draw a number of random variates *N* from the dispersal kernel equivalent to the adult population in that time step
2. Draw a uniform random number θ between 0 and 2π, which is used to choose a direction for dispersal.
3. Calculate the relative location of the dispersed individuals using trig functions:
     x  = cos(θ) d
     y = sin(θ) d
4. Store the new location coordinates (x, y) in a list that is sorted by time step.

The spatial-temporal model is applied at each year, with offspring maturing into adults at 5 years.This creates a new population (Generation 1) with new adult trees that occur starting in Year 5.  As a result, Gen 3 offspring that mature into adult show up in the model between years 15 to 20 (see timeline).

##Timeline

```{r Timeline, echo=FALSE, fig.cap='Figure 5. Timeline of each generation of new adult trees that will occur over the 20 year time horizon.'}
library(ggplot2)

Next.Gens <- read.table(text="Generation, Start, End
4, 20, 20
3, 15, 20
2, 10,  20
1, 5,  20
", 
                 header=TRUE,
                 sep = ',')

Next.Gens$TaskLabel <- Next.Gens$Generation
Next.Gens$Task <- as.numeric(Next.Gens$Generation)

p <- ggplot(Next.Gens, aes(colour=TaskLabel))
p <- p + geom_segment(aes(x=Start, 
                          xend=End, 
                          y=Task, 
                          yend=Task), 
                      size=2)
p <- p + geom_point(aes(x=Start,
                        y=Task),
                    size=3)
p <- p + geom_point(aes(x=End,
                        y=Task),
                    size=3)
p <- p + scale_y_discrete(limits = factor(c(1:4)))
p <- p + scale_x_discrete(limits = factor(c(1:20)))
p <- p + theme(legend.position="None")
p <- p + theme(axis.text.x= element_text(face = "bold"))
p <- p + theme(axis.text.y= element_text(face = "bold"))
p <- p + labs(title = "Generational Timeline",
              x = "Years",
              y = "Generations")
p <- p + theme(
  plot.title = element_text(hjust = 0.5, size = 18),
  plot.subtitle = element_text(hjust = 0.5)
)
p
```

##Generation 1
Generation 1 are the offspring of the intial offspring in the population model. The spatial-temporal model is applied at each year, with offspring maturing into adults after 4 years. As a result, Gen 1 adult trees show up in the model between years 4 to 20 (see timeline).

```{r Spread Model Generation 1}
set.seed(29807)                                             # Sets random number generation to static for reproducible results
allYears <- unname(allYears)                                # Turns the population into a table with no names
Adults <- round(allYears[3,])                               # Adult tree population years 1:20

NewPop <- list()                                            # Creates an empty list for coordinate storage
Spread <- function(t, yr, gen) {
  NewPop <- list()
  Time <- t
  year <- yr
  Gen <- gen
  for (i in Time:6) {                                         # for loop that iterates between over 20 time steps
    N <- sample(Distance, size = Adults[i], replace = FALSE)  # draw number of random variate from dist. Adults is num from pop table
    theta <- runif(N,0,2*pi)                                  # distance is assigned polar coordinates for direction
    NewPop[[i]] <- data.frame(x=cos(theta)*N, y=sin(theta)*N) # assign variate a coordinate x, y and store in a list
    NewPop[[i]]$Year <- i + year
    NewPop[[i]]$Generation <- Gen
    rbind(NewPop[[i]])
  }
#Bind yearly populations into one data frame
NewPop <- do.call(rbind, NewPop)
return(NewPop)
}


Gen1 <- list(Spread(21, -1, 1))
Gen1 <- do.call(rbind, Gen1)
row_sub = apply(Gen1, 1, function(row) all(row !=0 ))
Gen1 <- Gen1[row_sub,]
```

### Management 

**Asset Protection**
```{r Gen1 Asset Protection Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen1
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen1 <- gen

#create function apply management within protected area
Exclude <- function(gen, AP, yr){
  Exclusion <- filter(gen, radius > AP, Year %in% yr)
  return(Exclusion)
}

#storage for management results
Asset.Protec <- Exclude(Gen1, AP, Years)
```

**Containment Strategy**
```{r Gen1 Contain Management}
C1 <- 80     #containment boundary radius set
AP <- 550
Years <- c(1:20)    #years where management will occur

#create function apply management 
Contain <- function(gen, C1, AP, yr){
  Containment <- filter(gen, radius > C1 & radius < AP, Year %in% yr)
  return(Containment)
}

#storage for management results
Containment <- Contain(Gen1, C1, AP, Years)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Total.Remaining <- nrow(Gen1)
```

##Generation 2 {.tabset}

Generation 2 are the new adult trees that are the offspring of Generation 1 trees. The spatial-temporal model is applied at each year, with offspring maturing into adults after 4 years. As a result, Gen 2 offspring that mature into adults show up in the model between years 8 to 20 (see timeline).

###Year 5

```{r G2 Year 5 New Adults}
# Generation 2

# Year 5 New Population Growth

#function to count number of new populations to be simulated
nreps <- function(gen, yr){
  total <- nrow(filter(gen, Year == yr))
  return(total)
}

Gen2.Yr5 <- replicate(nreps(Gen1, 5), list(Spread(16, 4, 2)))
Gen2.Yr5 <- do.call(rbind, Gen2.Yr5)
row_sub = apply(Gen2.Yr5, 1, function(row) all(row !=0 ))
Gen2.Yr5 <- Gen2.Yr5[row_sub,]
orig.shft <- filter(Gen1, Year == 5)
Gen2.Yr5 <- Gen2.Yr5 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr5 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr5
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr5 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr5, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr5 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr5, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- Gen2.Yr5
Total.Pop <- rbind(Gen1, Gen2)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 6

```{r G2 Year 6 New Adults}
# Generation 2

# Year 6 New Population Growth

Gen2.Yr6 <- replicate(nreps(Gen1, 6), list(Spread(15, 5, 2)))
Gen2.Yr6 <- do.call(rbind, Gen2.Yr6)
row_sub = apply(Gen2.Yr6, 1, function(row) all(row !=0 ))
Gen2.Yr6 <- Gen2.Yr6[row_sub,]
orig.shft <- filter(Gen1, Year == 6)
Gen2.Yr6 <- Gen2.Yr6 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr6 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr6
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr6 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr6, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr6 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr6, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr6)
Total.Pop <- rbind(Total.Pop, Gen2.Yr6)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 7

```{r G2 Year 7 New Adults}
# Generation 2
# Year 7 New Population Growth
# Time steps at 13

Gen2.Yr7 <- replicate(nreps(Gen1, 7), list(Spread(14, 6, 2)))
Gen2.Yr7 <- do.call(rbind, Gen2.Yr7)
row_sub = apply(Gen2.Yr7, 1, function(row) all(row !=0 ))
Gen2.Yr7 <- Gen2.Yr7[row_sub,]
orig.shft <- filter(Gen1, Year == 7)
Gen2.Yr7 <- Gen2.Yr7 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr7 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr7
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr7 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr7, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr7 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr7, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr7)
Total.Pop <- rbind(Total.Pop, Gen2.Yr7)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 8

```{r G2 Year 8 New Adults}
# Generation 2
# Year 8 New Population Growth

Gen2.Yr8 <- replicate(nreps(Gen1, 8), list(Spread(13, 7, 2)))
Gen2.Yr8 <- do.call(rbind, Gen2.Yr8)
row_sub = apply(Gen2.Yr8, 1, function(row) all(row !=0 ))
Gen2.Yr8 <- Gen2.Yr8[row_sub,]
orig.shft <- filter(Gen1, Year == 8)
Gen2.Yr8 <- Gen2.Yr8 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr8 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr8
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr8 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr8, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr8 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr8, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr8)
Total.Pop <- rbind(Total.Pop, Gen2.Yr8)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 9

```{r G2 Year 9 New Adults}
# Generation 2
# Year 9 New Population Growth

Gen2.Yr9 <- replicate(nreps(Gen1, 9), list(Spread(12, 8, 2)))
Gen2.Yr9 <- do.call(rbind, Gen2.Yr9)
row_sub = apply(Gen2.Yr9, 1, function(row) all(row !=0 ))
Gen2.Yr9 <- Gen2.Yr9[row_sub,]
orig.shft <- filter(Gen1, Year == 9)
Gen2.Yr9 <- Gen2.Yr9 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr9 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr9
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr9 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr9, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr9 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr9, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr9)
Total.Pop <- rbind(Total.Pop, Gen2.Yr9)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 10

```{r G2 Year 10 New Adults}
# Generation 2
# Year 10 New Population Growth

Gen2.Yr10 <- replicate(nreps(Gen1, 10), list(Spread(11, 9, 2)))
Gen2.Yr10 <- do.call(rbind, Gen2.Yr10)
row_sub = apply(Gen2.Yr10, 1, function(row) all(row !=0 ))
Gen2.Yr10 <- Gen2.Yr10[row_sub,]
orig.shft <- filter(Gen1, Year == 10)
Gen2.Yr10 <- Gen2.Yr10 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr10 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr10
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr10 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr10, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr10 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr10, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr10)
Total.Pop <- rbind(Total.Pop, Gen2.Yr10)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 11

```{r G2 Year 11 New Adults}
# Generation 2
# Year 11 New Population Growth

Gen2.Yr11 <- replicate(nreps(Gen1, 11), list(Spread(10, 10, 2)))
Gen2.Yr11 <- do.call(rbind, Gen2.Yr11)
row_sub = apply(Gen2.Yr11, 1, function(row) all(row !=0 ))
Gen2.Yr11 <- Gen2.Yr11[row_sub,]
orig.shft <- filter(Gen1, Year == 11)
Gen2.Yr11 <- Gen2.Yr11 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```


####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr11 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr11
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr11 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr11, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr11 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr11, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr11)
Total.Pop <- rbind(Total.Pop, Gen2.Yr11)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 12

```{r G2 Year 12 New Adults}
# Generation 2
# Year 12 New Population Growth
# Time steps at 9

Gen2.Yr12 <- replicate(nreps(Gen1, 12), list(Spread(9, 11, 2)))
Gen2.Yr12 <- do.call(rbind, Gen2.Yr12)
row_sub = apply(Gen2.Yr12, 1, function(row) all(row !=0 ))
Gen2.Yr12 <- Gen2.Yr12[row_sub,]
orig.shft <- filter(Gen1, Year == 12)
Gen2.Yr12 <- Gen2.Yr12 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr12 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr12
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr12 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr12, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr12 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr12, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr12)
Total.Pop <- rbind(Total.Pop, Gen2.Yr12)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 13

```{r G2 Year 13 New Adults}
# Generation 2
# Year 13 New Population Growth
# Time steps at 8

Gen2.Yr13 <- replicate(nreps(Gen1, 13), list(Spread(8, 12, 2)))
Gen2.Yr13 <- do.call(rbind, Gen2.Yr13)
row_sub = apply(Gen2.Yr13, 1, function(row) all(row !=0 ))
Gen2.Yr13 <- Gen2.Yr13[row_sub,]
orig.shft <- filter(Gen1, Year == 13)
Gen2.Yr13 <- Gen2.Yr13 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr13 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr13
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr13 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr13, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr13 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr13, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr13)
Total.Pop <- rbind(Total.Pop, Gen2.Yr13)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 14

```{r G2 Year 14 New Adults}
# Generation 2
# Year 14 New Population Growth
# Time steps at 7

Gen2.Yr14 <- replicate(nreps(Gen1, 14), list(Spread(7, 13, 2)))
Gen2.Yr14 <- do.call(rbind, Gen2.Yr14)
row_sub = apply(Gen2.Yr14, 1, function(row) all(row !=0 ))
Gen2.Yr14 <- Gen2.Yr14[row_sub,]
orig.shft <- filter(Gen1, Year == 14)
Gen2.Yr14 <- Gen2.Yr14 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr14 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr14
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr14 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr14, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr14 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr14, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr14)
Total.Pop <- rbind(Total.Pop, Gen2.Yr14)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 15

```{r G2 Year 15 New Adults}
# Generation 2
# Year 15 New Population Growth
# Time steps at 6

Gen2.Yr15 <- replicate(nreps(Gen1, 15), list(Spread(6, 14, 2)))
Gen2.Yr15 <- do.call(rbind, Gen2.Yr15)
row_sub = apply(Gen2.Yr15, 1, function(row) all(row !=0 ))
Gen2.Yr15 <- Gen2.Yr15[row_sub,]
orig.shft <- filter(Gen1, Year == 15)
Gen2.Yr15 <- Gen2.Yr15 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen2.Yr15 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen2.Yr15
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen2.Yr15 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen2.Yr15, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen2.Yr15 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen2.Yr15, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen2 <- rbind(Gen2, Gen2.Yr15)
Total.Pop <- rbind(Total.Pop, Gen2.Yr15)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

##Generation 3 {.tabset}

Generation 3 are the new adult trees that are the offspring of Generation 2 trees. The spatial-temporal model is applied at each year, with offspring maturing into adults after 4 years. As a result, Gen 3 offspring that mature into adults show up in the model between years 12 to 20 (see timeline).

###Year 10

```{r G3 Year 10 New Adults}
# Generation 3
# Year 10 New Population Growth

Gen3.Yr10 <- replicate(nreps(Gen2.Yr5, 10), list(Spread(11, 9, 3)))
Gen3.Yr10 <- do.call(rbind, Gen3.Yr10)
row_sub = apply(Gen3.Yr10, 1, function(row) all(row !=0 ))
Gen3.Yr10 <- Gen3.Yr10[row_sub,]
orig.shft <- filter(Gen2.Yr5, Year == 10)
Gen3.Yr10 <- Gen3.Yr10 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen3.Yr10 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen3.Yr10
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen3.Yr10 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen3.Yr10, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen3.Yr10 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen3.Yr10, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen3 <- Gen3.Yr10
Total.Pop <- rbind(Total.Pop, Gen3.Yr10)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 11

```{r G3 Year 11 New Adults}
# Generation 3
# Year 11 New Population Growth
# Time steps at 10

Gen3.Yr11 <- replicate(nreps(Gen2.Yr6, 11), list(Spread(10, 10, 3)))
Gen3.Yr11 <- do.call(rbind, Gen3.Yr11)
row_sub = apply(Gen3.Yr11, 1, function(row) all(row !=0 ))
Gen3.Yr11 <- Gen3.Yr11[row_sub,]
orig.shft <- filter(Gen2.Yr6, Year == 11)
Gen3.Yr11 <- Gen3.Yr11 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen3.Yr11 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen3.Yr11
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen3.Yr11 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen3.Yr11, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen3.Yr11 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen3.Yr11, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen3 <- rbind(Gen3, Gen3.Yr11)
Total.Pop <- rbind(Total.Pop, Gen3.Yr11)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 12

```{r G3 Year 12 New Adults}
# Generation 3
# Year 12 New Population Growth

Gen3.Yr12 <- replicate(nreps(Gen2.Yr7, 12), list(Spread(9, 11, 3)))
Gen3.Yr12 <- do.call(rbind, Gen3.Yr12)
row_sub = apply(Gen3.Yr12, 1, function(row) all(row !=0 ))
Gen3.Yr12 <- Gen3.Yr12[row_sub,]
orig.shft <- filter(Gen2.Yr7, Year == 12)
Gen3.Yr12 <- Gen3.Yr12 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen3.Yr12 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen3.Yr12
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen3.Yr12 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen3.Yr12, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen3.Yr12 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen3.Yr12, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen3 <- rbind(Gen3, Gen3.Yr12)
Total.Pop <- rbind(Total.Pop, Gen3.Yr12)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 13

```{r G3 Year 13 New Adults}
# Generation 3
# Year 13 New Population Growth
# Time steps at 8

Gen3.Yr13 <- replicate(nreps(Gen2.Yr8, 13), list(Spread(8, 12, 3)))
Gen3.Yr13 <- do.call(rbind, Gen3.Yr13)
row_sub = apply(Gen3.Yr13, 1, function(row) all(row !=0 ))
Gen3.Yr13 <- Gen3.Yr13[row_sub,]
orig.shft <- filter(Gen2.Yr8, Year == 13)
Gen3.Yr13 <- Gen3.Yr13 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen3.Yr13 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen3.Yr13
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen3.Yr13 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen3.Yr13, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen3.Yr13 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen3.Yr13, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen3 <- rbind(Gen3, Gen3.Yr13)
Total.Pop <- rbind(Total.Pop, Gen3.Yr13)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 14

```{r G3 Year 14 New Adults}
# Generation 3
# Year 14 New Population Growth

Gen3.Yr14 <- replicate(nreps(Gen2.Yr9, 14), list(Spread(7, 13, 3)))
Gen3.Yr14 <- do.call(rbind, Gen3.Yr14)
row_sub = apply(Gen3.Yr14, 1, function(row) all(row !=0 ))
Gen3.Yr14 <- Gen3.Yr14[row_sub,]
orig.shft <- filter(Gen2.Yr9, Year == 14)
Gen3.Yr14 <- Gen3.Yr14 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen3.Yr14 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen3.Yr14
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen3.Yr14 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen3.Yr14, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen3.Yr14 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen3.Yr14, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen3 <- rbind(Gen3, Gen3.Yr14)
Total.Pop <- rbind(Total.Pop, Gen3.Yr14)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

###Year 15

```{r G3 Year 15 New Adults}
# Generation 3
# Year 15 New Population Growth

Gen3.Yr15 <- replicate(nreps(Gen2.Yr10, 15), list(Spread(6, 14, 3)))
Gen3.Yr15 <- do.call(rbind, Gen3.Yr15)
row_sub = apply(Gen3.Yr15, 1, function(row) all(row !=0 ))
Gen3.Yr15 <- Gen3.Yr15[row_sub,]
orig.shft <- filter(Gen2.Yr10, Year == 15)
Gen3.Yr15 <- Gen3.Yr15 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen3.Yr15 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen3.Yr15
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen3.Yr15 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen3.Yr15, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen3.Yr15 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen3.Yr15, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen3 <- rbind(Gen3, Gen3.Yr15)
Total.Pop <- rbind(Total.Pop, Gen3.Yr15)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

##Generation 4 {.tabset}
Generation 4 are the new adult trees that are the offspring of Generation 3 trees. The spatial-temporal model is applied at each year, with offspring maturing into adults after 4 years. As a result, Gen 4 offspring that mature into adults show up in the model between years 16 to 20 (see timeline).

###Year 15

```{r G4 Year 15 New Adults}
# Generation 4
# Year 15 New Population Growth

Gen4.Yr15 <- replicate(nreps(Gen3.Yr10, 15), list(Spread(6, 14, 4)))
Gen4.Yr15 <- do.call(rbind, Gen4.Yr15)
row_sub = apply(Gen4.Yr15, 1, function(row) all(row !=0 ))
Gen4.Yr15 <- Gen4.Yr15[row_sub,]
orig.shft <- filter(Gen3.Yr10, Year == 15)
Gen4.Yr15 <- Gen4.Yr15 %>%
  mutate(x = x + orig.shft[,1], y = y + orig.shft[,2])
```

####Management

**Exlusion/Asset Protection Strategy**

```{r Gen4.Yr15 AP Management}
# years where management will occur
Years <- c(1:20)

# radius from invasion point
AP <- 550

## add radius distance to polar coordinates
gen <- Gen4.Yr15
row.sums <- apply(gen[1:2]^2, 1, sum)
row.sums <- sqrt(row.sums)
gen <- rbind(cbind(gen, radius = row.sums))
Gen4.Yr15 <- gen

#storage for management results
Asset.Protec2 <- Exclude(Gen4.Yr15, AP, Years)

# Update count of total trees managed
Asset.Protec <- rbind(Asset.Protec, Asset.Protec2)
```

**Containment Strategy**

```{r Gen4.Yr15 Cont Management}
C1 <- 80     #containment boundary set
AP <- 550
Years <- c(1:20)    #years where management will occur

#storage for management results
Containment2 <- Contain(Gen4.Yr15, C1, AP, Years)

#update total tree managed
Containment <- rbind(Containment, Containment2)

Total.Managed <- nrow(Asset.Protec) + nrow(Containment)

Gen4 <- Gen4.Yr15
Total.Pop <- rbind(Total.Pop, Gen4.Yr15)
Total.Remaining <- nrow(Total.Pop) - Total.Managed
```

```{r Plot}
library(gridExtra)
library(grid)
library(ggforce)

center <- Total.Pop %>%
                   filter(radius < 80)
plot80 <- Total.Pop %>%
  filter(radius >= 80 & radius < 125)
plot125 <- Total.Pop %>%
  filter(radius >= 125 & radius < 550)
plot550 <- Total.Pop %>%
  filter(radius >= 550)

p1 <- ggplot(Total.Pop) + 
  theme(aspect.ratio = 1) +
  geom_point(aes(x = x, y = y))  
p1 <- p1 + geom_point(data = center, aes(x = x, y = y),
             color = "blue",
             alpha = 1/2)
p1 <- p1 + geom_point(data = plot80, aes(x = x, y = y),
             color = "red",
             alpha = 1/2)
p1 <- p1 + geom_point(data = plot125, aes(x = x, y = y),
             color = "green",
             alpha = 1/2)
p1 <- p1 + geom_point(data = plot550, aes(x = x, y = y),
             color = "brown",
             alpha = 1/2)
p1 <- p1 + geom_point(aes(x = 0, y = 0))
p1 <- p1 + geom_circle(aes(x0 = 0, y0 = 0, r = 550))
p1 <- p1 + geom_circle(aes(x0 = 0, y0 = 0, r = 80))
p1 <- p1 + geom_circle(aes(x0 = 0, y0 = 0, r = 125)) +
labs(x = "Distance (meters)",
     y = "Distance (meters)") + 
  theme(plot.title = element_text(hjust = 0.5, size = 22)) +
  ylim(-1000,1000)+
  xlim(-1000,1000)
p1 <- p1 + annotate("text", x = 0, y = -96, label = "80 m", size = 3)
p1 <- p1 + annotate("text", x = 0, y = -146, label = "125 m", size = 3)
p1 <- p1 + annotate("text", x = 0, y = -575, label = "550 m", size = 3)
p1 <- p1 + annotate("text", x = 500, y = -750, label = "N = 3973", size = 5)
p1
```

```{r plotz}
library(gridExtra)
library(grid)
library(ggforce)

p1 <- ggplot() +
  theme(aspect.ratio = 1) +
  geom_point(Total.Pop, mapping = aes(x = x, y = y, 
                                      color = Year,
                                      shape = factor(Generation)),
             size = 1, 
             alpha = 0.8)
p1 <- p1 + geom_point(aes(x = 0, y = 0))
p1 <- p1 + geom_circle(aes(x0 = 0, y0 = 0, r = 550))
p1 <- p1 + geom_circle(aes(x0 = 0, y0 = 0, r = 80))
p1 <- p1 + geom_circle(aes(x0 = 0, y0 = 0, r = 125)) +
labs(title = "No Management",
     subtitle = "36k fecundity, 90% survivoship",
     shape = "Generation",
     x = "Distance (meters)",
     y = "Distance (meters)") + 
  theme(plot.title = element_text(hjust = 0.5, size = 18),
        plot.subtitle = element_text(hjust = 0.5, size = 12)) +
  ylim(-1000,1000)+
  xlim(-1000,1000)
p1 <- p1 + annotate("text", x = 0, y = -96, label = "80 m", size = 3)
p1 <- p1 + annotate("text", x = 0, y = -146, label = "125 m", size = 3)
p1 <- p1 + annotate("text", x = 0, y = -575, label = "550 m", size = 3)
p1
```

```{r Plots2}

p2 <- ggplot() +
  theme(aspect.ratio = 1)
p2 <- p2 + geom_point(aes(x = 0, y = 0))
p2 <- p2 + geom_circle(aes(x0 = 0, y0 = 0, r = 550))
p2 <- p2 + geom_circle(aes(x0 = 0, y0 = 0, r = 80))
p2 <- p2 + geom_circle(aes(x0 = 0, y0 = 0, r = 125)) +
labs(title = "Mangement Boundaries",
     x = "Distance (meters)",
     y = "Distance (meters)") + 
  theme(plot.title = element_text(hjust = 0.5, size = 22)) +
  ylim(-650,650)+
  xlim(-650,650)
p2 <- p2 + annotate("text", x = 0, y = -96, label = "80 m", size = 3)
p2 <- p2 + annotate("text", x = 0, y = -146, label = "125 m", size = 3)
p2 <- p2 + annotate("text", x = 0, y = -575, label = "550 m", size = 3)
p2
```

##Outputs

```{r Outputs}
library(readxl)

#Functions for outputs and evaluation
AP.list <- list()
for(i in 1:20){
  AP.list[[i]] <- nrow(filter(Asset.Protec, Year == i))
  rbind(AP.list[[i]])
}
AP.list <- do.call(rbind, AP.list)

Contain.list <- list()
for(i in 1:20){
  Contain.list[[i]] <- nrow(filter(Containment, Year == i))
  rbind(Contain.list[[i]])
}
Contain.list <- do.call(rbind, Contain.list)

Pop.list <- list()
for(i in 1:20){
  Pop.list[[i]] <- nrow(filter(Total.Pop, Year == i))
  rbind(Pop.list[[i]])
}
Pop.list <- do.call(rbind, Pop.list)
#Containment/Exclusion
#write.xlsx(Contain.list, file = "NoMng_36KFecundity_90AdultSurv_C1.xlsx")
#Asset Protection
#write.xlsx(AP.list, file = "NoMng_36KFecundity_90AdultSurv_C1AP.xlsx")
#Unmanaged Population
#write.xlsx(Pop.list, file = "NoMng_36KFecundity_90AdultSurv_byYear.xlsx")
#OverPop
#write.xlsx(Total.Pop, file = "NoMng_36KFecundity_90AdultSurv.xlsx")
```
